---
title: FIDO
---

<% content_for :head do %>
  <link rel="stylesheet" type="text/css" href="../assets/stylesheets/fido.css" />
<% end %>

<div id="top-panel">
  <div id="navigation-throttle-and-buttons" class="gauge">
    <%= render 'navball' %>
    <div id="button-panel">
      <%= render 'button', :button_id => "rcs", :button_label => "RCS" %>
      <%= render 'button', :button_id => "sas", :button_label => "SAS" %>
    </div>
  </div>

  <div id="throttle-panel">
    <%= render 'throttle' %>
  </div>

  <div id="position-map" class="map readout-display"></div>

  <div class="readout-display">
    <h2>Orbit Info</h2>
    <table id="orbit-info" class="readout-table"></table>
  </div>
</div>

<div id="bottom-panel">
  <div class="readout-display">
    <h2>Danger Zone</h2>
    <table id="vessel-speed" class="readout-table"></table>
  </div>

  <div class="readout-display">
    <h2>Docking Info</h2>
    <table id="docking-info" class="readout-table"></table>
  </div>

  <div class="readout-display">
    <h2>Hohmann Transfer Tool</h2>
    <strong id="go-signal"></strong>
    <table class="readout-table">
      <tr>
        <th>Vessel Altitude</th>
        <td id="vessel-altitude"></td>
      </tr>

      <tr>
        <th>Vessel Orbital Velocity</th>
        <td id="vessel-orbital-velocity"></td>
      </tr>

      <tr>
        <th>Vessel Periapsis</th>
        <td id="vessel-periapsis"></td>
      </tr>

      <tr>
        <th>Target Periapsis</th>
        <td id="target-periapsis"></td>
      </tr>

      <tr>
        <th>Delta-V</th>
        <td id="delta-v"></td>
      </tr>

      <tr>
        <th>Sweep Angle</th>
        <td id="sweep-angle"></td>
      </tr>

      <tr>
        <th>Phase Angle</th>
        <td id="phase-angle"></td>
      </tr>

      <tr>
        <th>Target's Current Phase Angle</th>
        <td id="target-current-phase-angle"></td>
      </tr>
    </table>
  </div>

  <div id="manuever_nodes" class="readout-display">
    <h2>Manuever Node Editor</h2>
    <div>
      <div id="node_list">
        <div id="no_maneuver_nodes">No Nodes!</div>
        <select id="maneuver_node"></select>
        <ul id="node_selector"></ul>
        <button id="add_node">Add Node</button>
      </div>
      <table id="node_editor">
        <tr>
          <th>Increment</th>
          <td>
            <select id="node_quick_increment">
              <option>0.01</option>
              <option>0.1</option>
              <option>1</option>
              <option selected="selected">10</option>
              <option>100</option>
            </select>
          </td>
        </tr>
        <tr>
          <th>UT</th>
          <td>
            <input id="node_ut" type="number">
            <button id="node_ut_plus">+</button>
            <button id="node_ut_minus">-</button>
          </td>
        </tr>
        <tr>
          <td id="ut_buttons" colspan="2">
            <button id="node_ut_ap">AP</button>
            <button id="node_ut_pe">PE</button>
            <button id="node_ut_1k_plus">+1K</button>
            <button id="node_ut_1k_minus">-1K</button>
          </td>
        </tr>
        <tr>
          <th>Prograde</th>
          <td>
            <input id="node_prograde" type="number">
            <button id="node_prograde_plus">+</button>
            <button id="node_prograde_minus">-</button>
          </td>
        </tr>
        <tr>
          <th>Normal</th>
          <td>
            <input id="node_normal" type="number">
            <button id="node_normal_plus">+</button>
            <button id="node_normal_minus">-</button>
          </td>
        </tr>
        <tr>
          <th>Radial</th>
          <td>
            <input id="node_radial" type="number">
            <button id="node_radial_plus">+</button>
            <button id="node_radial_minus">-</button>
          </td>
        </tr>
        <tr>
          <th>&Delta;v</th><td id="node_delta_v"></td>
        </tr>
      </table>
      <table id="node_orbit_info"></table>
    </div>
  </div>
</div>

<% content_for :dom_loaded do %>
  window.navball = new Navball(window.datalink, 'navball', 'navball-heading')
  window.rcsButtonIndicator = new ButtonIndicator(datalink, 'rcs', 'v.rcsValue')
  window.sasButtonIndicator = new ButtonIndicator(datalink, 'sas', 'v.sasValue')
  window.throttleGauge = new ThrottleGauge(window.datalink, 'throttle')

  window.positionMap = new PositionMap(datalink, 'position-map')

  window.orbitInfoTable = new ReadoutTable(datalink, 'orbit-info', [
    {
      label: "Altitude",
      value: 'v.altitude',
      formatter: function(value){ return DataFormatters.distanceString(value) }
    },
    {
      label: "Apoapsis",
      value: 'o.ApA',
      formatter: function(value){ return DataFormatters.distanceString(value) }
    },
    {
      label: "Periapsis",
      value: 'o.PeA',
      formatter: function(value){ return DataFormatters.distanceString(value) }
    },
    {
      label: "Time to Apoapsis",
      value: 'o.timeToAp',
      formatter: function(value){ return "-" + TimeFormatters.durationString(value) }
    },
    {
      label: "Time to Periapsis",
      value: 'o.timeToPe',
      formatter: function(value){ return "-" + TimeFormatters.durationString(value) }
    },
    {
      label: "Inclination",
      value: 'o.inclination',
      formatter: function(value){ return DataFormatters.degreeString(value) }
    },
    {
      label: "Eccentricity",
      value: 'o.eccentricity',
      formatter: function(value){ return value.toFixed(3) }
    },
    {
      label: "Orbital Period",
      value: 'o.period',
      formatter: function(value){ return TimeFormatters.durationString(value) }
    },
    {
      label: "True Anomaly",
      value: 'o.trueAnomaly',
      formatter: function(value){ return DataFormatters.degreeString(value) }
    },
  ])

  window.dockingInfoTable = new ReadoutTable(datalink, 'docking-info', [
    {
      label: "X Angle",
      value: 'dock.ax',
      formatter: function(value){ return DataFormatters.degreeString(value) }
    },
    {
      label: "Y Angle",
      value: 'dock.ay',
      formatter: function(value){ return DataFormatters.degreeString(value) }
    },
    {
      label: "Z Angle",
      value: 'dock.az',
      formatter: function(value){ return DataFormatters.degreeString(value) }
    },
    {
      label: "X Distance",
      value: 'dock.x',
      formatter: function(value){ return DataFormatters.distanceString(value) }
    },
    {
      label: "Y Distance",
      value: 'dock.y',
      formatter: function(value){ return DataFormatters.distanceString(value) }
    }
  ])

  window.vesselSpeedTable = new ReadoutTable(datalink, 'vessel-speed', [
    {
      label: "Surface Velocity",
      value: 'v.surfaceVelocity',
      formatter: function(value){ return DataFormatters.velocityString(value) }
    },
    {
      label: "Vertical Velocity",
      value: 'v.verticalSpeed',
      formatter: function(value){ return DataFormatters.velocityString(value) }
    },
    {
      label: "Orbital Velocity",
      value: 'v.orbitalVelocity',
      formatter: function(value){ return DataFormatters.velocityString(value) }
    },
    {
      label: "Vessel's Relative Velocity",
      value: 'o.relativeVelocity',
      formatter: function(value){ return DataFormatters.velocityString(value) }
    },
    {
      label: "Target's Relative Velocity",
      value: 'tar.o.relativeVelocity',
      formatter: function(value){ return DataFormatters.velocityString(value) }
    },
    {
      label: "G-Force",
      value: 'v.geeForce',
      formatter: function(value){ return value.toFixed(3) }
    },
  ])

  window.nodeEditor = new ManeuverNodeEditor(window.datalink,{
    //control elements
    maneuverNode: $('maneuver_node'),
    quickIncrement: $('node_quick_increment'),
    ut: $('node_ut'),
    utPlus: $('node_ut_plus'),
    utMinus: $('node_ut_minus'),
    utAp: $('node_ut_ap'),
    utPe: $('node_ut_pe'),
    ut1KPlus: $('node_ut_1k_plus'),
    ut1KMinus: $('node_ut_1k_minus'),
    prograde: $('node_prograde'),
    progradePlus: $('node_prograde_plus'),
    progradeMinus: $('node_prograde_minus'),
    normal: $('node_normal'),
    normalPlus: $('node_normal_plus'),
    normalMinus: $('node_normal_minus'),
    radial: $('node_radial'),
    radialPlus: $('node_radial_plus'),
    radialMinus: $('node_radial_minus'),
    nodeSelector: $('node_selector'),
    addNode: $('add_node'),

    //display elements
    deltaV: $('node_delta_v'),
    orbitInfoTable: $('node_orbit_info'),
    noManeuverNodesMessage: $('no_maneuver_nodes'),
  })

  window.intercept = new HohmannIntercept(window.datalink)

  document.observe('hohmann-intercept:update', function(){
    var updateValue = function(id, value, updateFunction){
      $(id).update(updateFunction(value))
    }

    if(!intercept.deltaV){
      $('go-signal').update("NO TARGET SELECTED")
      return
    }

    updateValue('vessel-altitude', intercept.vessel.altitude, DataFormatters.distanceString)

    // $('vessel-altitude').update(numeral.format())
    updateValue('vessel-orbital-velocity', intercept.vessel.orbitalVelocity, DataFormatters.velocityString)
    updateValue('vessel-periapsis', intercept.vessel.periapsis, DataFormatters.distanceString)
    updateValue('target-periapsis', intercept.targetBody.periapsis, DataFormatters.distanceString)
    updateValue('delta-v', intercept.deltaV, DataFormatters.velocityString)
    updateValue('sweep-angle', intercept.sweepAngle, DataFormatters.degreeString)
    updateValue('phase-angle', intercept.phaseAngle, DataFormatters.degreeString)
    updateValue('target-current-phase-angle', intercept.targetsCurrentPhaseAngle, DataFormatters.degreeString)

    if(intercept.isGoForIntercept()){
      $('go-signal').update("GO FOR MANUEVER")
    }
  })
<% end %>